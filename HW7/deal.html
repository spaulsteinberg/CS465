<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Deal or No Deal</title>
        <meta charset="UTF-8">
        <script>
        var ids = [];
        var vals = [];
        var valueArray = [0.01, 1, 5, 10, 100, 1000, 10000, 100000, 500000, 1000000];
        var selectedCase = "";
        var total = 0;
        initializeBoard(); //so it starts intialized;
        function initializeBoard(){
            count = 0;
            shuffle(valueArray);
            vals = valueArray;
            total = 1611116.01;
            var checkBoxes = document.getElementsByClassName("cbox");
            for (var i = 0; i < checkBoxes.length; i++){
                checkBoxes.item(i).checked = false;
            }
            var suitcases = document.getElementsByClassName("suitcase");
            for (var i = 0; i < suitcases.length; i++){
                suitcases.item(i).value = valueArray[i];
            }
            document.getElementById("bottom-button-deal").disabled = true;
        }
        /* ES6 shuffling from site ! */
        function shuffle(cleanArray) {
            for (let i = cleanArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [cleanArray[i], cleanArray[j]] = [cleanArray[j], cleanArray[i]];
            }
            return cleanArray;
        }
        /* keep user from inadvertant check */
        function badCheck(){
            var checkBox = document.getElementById(event.target.id)
            checkBox.checked = false;
            return false;
        }

        function checkVal(){
            var flag = false;
            total = 1611116.01;
            var sum = 0;
            var zeroed = 0;
            var suitcases = document.getElementsByClassName("suitcase");
            for (var i = 0; i < suitcases.length; i++){
                if (suitcases.item(i).clicked == true){
                    flag = true;
                }
                ids[i] = suitcases.item(i).id;
            }
            if (flag == false){
                var box = document.getElementById(event.target.id);
                selectedCase = event.target.id;
                box.clicked = true;
                box.disabled = true;
                box.style.backgroundColor = "blue";
                box.style.color = "silver";
            }
            else {
                document.getElementById("bottom-button-deal").disabled = false;
                var box = document.getElementById(event.target.id);
                var index = -1;
                for (var i = 0; i < suitcases.length; i++){
                    if (suitcases.item(i).id == event.target.id){
                        index = i;
                        break;
                    }
                }
                var checkBoxes = document.getElementsByClassName("cbox");
                for (var j = 0; j < checkBoxes.length; j++){
                    if (checkBoxes.item(j).value == vals[index]){
                        checkBoxes.item(j).checked = true;
                    }
                }
                box.clicked = true;
                box.disabled = true;
                box.style.backgroundColor = "gold";
                box.textContent = "$" + vals[index];
                var sum = 0;
                var zeroed = [];
                var j = 0;
                for (var i = 0; i < suitcases.length; i++){
                    if (suitcases.item(i).clicked == true){
                        zeroed[j] = i;
                        j++;
                    }
                }
                console.log(zeroed);
                for (var i = 0; i < suitcases.length; i++){
                    if (!zeroed.includes(i)){
                        sum += vals[i];
                    }
                }
                var suitcases = document.getElementsByClassName("suitcase");
                var caseValue = -1;
                for (var i = 0; i < suitcases.length; i++){
                    if (suitcases.item(i).id == selectedCase){
                        caseValue = vals[i];
                        break;
                    }
                }
                console.log(sum + caseValue);
                var offer = Math.floor((sum+caseValue)/(11-zeroed.length)*.9);
                var box = document.getElementById("offer-box");
                box.value = offer;
            }
            var allDoneFlag = false;
            for (var i = 0; i < suitcases.length; i++){
                if (suitcases.item(i).clicked == true){
                    continue;
                }
                else {
                    allDoneFlag = true;
                }
            }
            if (allDoneFlag == false){
                var sum = 0;
                var zeroed = 0;
                suitcasesExhausted();
                initializeBoard();
            }
            if(document.getElementById("bottom-button-deal").clicked == true){
                var sum = 0;
                var zeroed = 0;
                var box = document.getElementById("offer-box");
                alert("Deal! You won: " + "$" + box.value);
                document.getElementById("bottom-button-deal").textContent = "Deal";
                
                var suitcases = document.getElementsByClassName("suitcase");
                var caseValue = -1;
                for (var i = 0; i < suitcases.length; i++){
                    if (suitcases.item(i).id == selectedCase){
                        caseValue = vals[i];
                        break;
                    }
                }
                for (var i = 0; i < suitcases.length; i++){
                    suitcases.item(i).disabled = true;
                }
                document.getElementById(selectedCase).textContent = "$" + caseValue;
                alert("The value in your case was: " + "$" + caseValue);
                document.getElementById("bottom-button-deal").color = "black";
                initializeBoard();
            }
        }
        function suitcasesExhausted(){
            var suitcases = document.getElementsByClassName("suitcase");
            var caseValue = -1;
            for (var i = 0; i < suitcases.length; i++){
                if (suitcases.item(i).id == selectedCase){
                    caseValue = vals[i];
                    break;
                }
            }
            for (var i = 0; i < suitcases.length; i++){
                suitcases.item(i).disabled = true;
            }
            document.getElementById(selectedCase).textContent = "$" + caseValue;
            alert("Game Over! The value in your case was: " + "$" + caseValue);
        }
        </script>
    </head>
    <body>
        <h2>Instructions</h2>
        <p>To play click on the Start Game button</p>
        <p>Choose one of the 10 light blue buttons to be your suitcase
            that you may choose to hold until the end of the game.
        </p>
        <p>Then choose another button, which corresponds to opening a suitcase with a certain money amount</p>
        <p>Then choose between Deal or opening another suicase. If you choose Deal, then the game ends and you win the 
            amount of money given in the offer box. If you open another suitcase, then you will recieve a new offer.
        </p>
        <p>Continue in this fashion until you choose Deal or until you have opened all of the suitcases, in which you will
            win the amount that is in the suitcase you chose at the beginning of the game.
        </p>
        <p>To play another game, just click on the Start Game button again.</p>
        <hr>
        <div class="deal-box">
            <form class="master-form">
                <div class="offer">
                    <label class="offer-label">Offer <input id="offer-box" class="offer-box" type="number" maxlength="7" readonly></label>
                </div>
                <div class="row">
                    <div class="column-1">
                        <table class="suitcase-buttons">
                            <tr class="button-group-1">
                                <td><button id="b-1" class="suitcase" onclick="checkVal()">1</button></td>
                                <td><button id="b-2" class="suitcase" onclick="checkVal()">2</button></td>
                                <td><button id="b-3" class="suitcase" onclick="checkVal()">3</button></td>
                                <td><button id="b-4" class="suitcase" onclick="checkVal()">4</button></td>
                                <td><button id="b-5" class="suitcase" onclick="checkVal()">5</button></td>
                            </tr>
                            <tr class="button-group-1">
                                <td><button id="b-6" class="suitcase" onclick="checkVal()">6</button></td>
                                <td><button id="b-7" class="suitcase" onclick="checkVal()">7</button></td>
                                <td><button id="b-8" class="suitcase" onclick="checkVal()">8</button></td>
                                <td><button id="b-9" class="suitcase" onclick="checkVal()">9</button></td>
                                <td><button id="b-10" class="suitcase" onclick="checkVal()">10</button></td>
                            </tr>
                        </table>
                    </div>
                    <div class="column-2">
                        <table class="amounts">
                            <tr><td><input type="checkbox" class="cbox" value="0.01" id="v-1" onclick="badCheck()">$0.01</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="1" id="v-2" onclick="badCheck()">$1</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="5" id="v-3" onclick="badCheck()">$5</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="10" id="v-4" onclick="badCheck()">$10</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="100" id="v-5" onclick="badCheck()">$100</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="1000" id="v-6" onclick="badCheck()">$1000</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="10000" id="v-7" onclick="badCheck()">$10000</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="100000" id="v-8" onclick="badCheck()">$100000</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="500000" id="v-9" onclick="badCheck()">$500000</td></tr>
                            <tr><td><input type="checkbox" class="cbox" value="1000000" id="v-10" onclick="badCheck()">$1000000</td></tr>
                        </table>
                    </div>
                </div>
                <div class="row">
                    <div class="admin-buttons">
                        <button id="bottom-button-deal" onclick="checkVal()" disabled>Deal</button>
                        <button id="bottom-button-start" onclick="initializeBoard()">Start New Game</button>
                    </div>
                </div>
            </form>
        </div>
    </body>
    <style>
        * {
            box-sizing: border-box;
        }
        .admin-buttons {
            display: flex;
            justify-content: center;
        }
        #bottom-button-start, #bottom-button-deal {
            color: yellow;
            background-color: green !important;
            width: 120px;
            padding: 15px 0px 15px 0px;
            margin-right: 5px;
        }
        .row:after {
            content: "";
            display: table;
            clear: both;
        }
        .column-1 {
            float: left;
            width: 60%;
        }
        .column-2 {
            float: left;
            width: 40%;
        }
        .suitcase {
            text-align: center;
        }
        .row {
            background-color: lightgreen;
            padding-bottom: 50px;
        }
        .button-group-1 {
            padding-bottom: 5px;
        }
        .button-group-1 td button {
            background-color: lightskyblue;
            width: 100%;
            height: 100%;
        }
        .button-group-1 td {
            width: 150px;
            height: 75px;
        }
        .master-form {
            padding: 20px;
        }
        .offer {
            display: flex;
            justify-content: center;
            padding-bottom: 50px;
        }
        .deal-box {
            background-color: lightgreen !important;
            border: 1px solid black;
        }
        .offer-box {
            width: 50%;
        }
    </style>
</html>